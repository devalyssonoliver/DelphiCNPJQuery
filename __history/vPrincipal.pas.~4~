unit vPrincipal;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs,
  Data.Bind.Components, Data.Bind.ObjectScope, Vcl.ComCtrls, Vcl.StdCtrls,
  Vcl.Mask, Vcl.ExtCtrls, System.RegularExpressions, uCNPJApiClient;

type
  TfrmPrincipal = class(TForm)
    pnlTopo: TPanel;
    pnlMeio: TPanel;
    pnlCampos: TPanel;
    medtCNPJ: TMaskEdit;
    lblCNPJTitle: TLabel;
    btnConsultar: TButton;
    mmoCONSULTA: TMemo;
    pbConsulta: TProgressBar;
    procedure btnConsultarClick(Sender: TObject);
  private
    { Private declarations }
    FApiCliente : TCNPJApiClient;
  public
    { Public declarations }
  end;

var
  frmPrincipal: TfrmPrincipal;

implementation



{$R *.dfm}

procedure TfrmPrincipal.btnConsultarClick(Sender: TObject);
var
  lCNPJ, lResposta : String;
begin
    lCNPJ := TRegEx.Replace(medtCNPJ.Text, '\D', '');
    FApiCliente := TCNPJApiClient.Create;
    try
      FApiCliente.Requisicao(lCNPJ, lResposta);
      mmoCONSULTA.Lines.Clear;
      mmoCONSULTA.Lines.Add(lResposta);
    except
       showmessage('deu erro');
    end;

end;

end.
